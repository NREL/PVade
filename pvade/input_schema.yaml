title: "PVade Schema"
description: "Definitions for a PVade simulation"
additionalProperties: false
type: "object"
properties:
  general:
    additionalProperties: false
    type: "object"
    # required:
    properties:
      test:
        default: false
        type: "boolean"
        description: "test if interpolation is done correctly"
      output_dir:
        default: "output/"
        type: "string"
        description: "The folder that will contain the output files for this run, formatted as a single string."
      geometry_module:
        default: "panels3d"
        type: "string"
        description: "The name of the directory in pvade/geometry/ that contains a DomainCreation.py file for generating the CAD description, prescribing mesh refinement, etc."
      input_mesh_file:
        default: null
        type:
          - "string"
          - "null"
        description: "The path to the input mesh.xdmf file to be used in the simulation, e.g., /inputs/case_1/mesh.xdmf"
      mesh_only:
        default: false
        type: "boolean"
        description: "If true, exit the PVade run immediately after generating the mesh without solving"
      structural_analysis:
        default: False 
        type: "boolean"
        description: "If true, conduct a structure analysis"
      fluid_analysis:
        default: true
        type: "boolean"
        description: "If true, conduct a fluid analysis"

  domain:
    additionalProperties: false
    type: "object"
    # required:
    # - x_min
    # - x_max
    properties:
      x_min:
        default: -100
        minimum: -1000
        maximum: 1000
        type: "number"
        description: "The minimum x-value of the fluid domain."
        units: "meter"
      x_max:
        default: 100
        minimum: -1000
        maximum: 1000
        type: "number"
        description: "The maximum x-value of the fluid domain."
        units: "meter"
      y_min:
        default: -100
        minimum: -1000
        maximum: 1000
        type: "number"
        description: "The minimum y-value of the fluid domain."
        units: "meter"
      y_max:
        default: 100
        minimum: -1000
        maximum: 1000
        type: "number"
        description: "The maximum y-value of the fluid domain."
        units: "meter"
      z_min:
        default: -100
        minimum: -1000
        maximum: 1000
        type: "number"
        description: "The minimum z-value of the fluid domain."
        units: "meter"
      z_max:
        default: 100
        minimum: -1000
        maximum: 1000
        type: "number"
        description: "The maximum z-value of the fluid domain."
        units: "meter"
      l_char:
        default: 10.0
        minimum: 0.01
        maximum: 100.0
        type: "number"
        description: "The characteristic length to use when building the mesh."
        units: "meter"
  pv_array:
    additionalProperties: false
    type: "object"
    properties:
      stream_rows:
        default: 3
        minimum: 1
        maximum: 10
        type: "integer"
        description: "The number of panel rows in the streamwise direction."
        units: "unitless"
      span_rows:
        default: 3
        minimum: 1
        maximum: 10
        type: "integer"
        description: "The number of panel rows in the spanwise direction."
        units: "unitless"
      elevation:
        default: 1.5
        minimum: 0.0
        maximum: 10.0
        type: "number"
        description: "The vertical distance between the center of the panel and the ground."
        units: "meter"
      stream_spacing:
        default: 7.0
        minimum: 1.0
        maximum: 32.0
        type: "number"
        description: "The separation between panel rows in the streamwise direction."
        units: "meter"
      span_spacing:
        default: 7.0
        minimum: 1.0
        maximum: 32.0
        type: "number"
        description: "The separation between panel rows in the spanwise direction."
        units: "meter"
      panel_chord:
        default: 2.0
        minimum: 0.0
        maximum: 10.0
        type: "number"
        description: "The length of the panels from the leading to the trailing edge."
        units: "meter"
      panel_span:
        default: 7.0
        minimum: 1.0
        # maximum: 10.0
        type: "number"
        description: "The length of the panel in the spanwise direction."
        units: "meter"
      panel_thickness:
        default: 0.1
        minimum: 0.0001
        maximum: 1.0
        type: "number"
        description: "The thickness of the panel."
        units: "meter"
      tracker_angle:
        default: 30.0
        minimum: -90.0
        maximum: 90.0
        type: "number"
        description: "The orientation of the panels, sign convention follows the right-hand rule about the positive y-axis, that is, a positive angle indicates the upstream edge is further from the ground and negative indicates the downstream edge is further from the ground."
        units: "degree"
  solver:
    additionalProperties: false
    type: "object"
    properties:
      dt:
        default: 0.002
        minimum: 0.0
        type: "number"
        description: "The timestep size to use in both the fluid and structural solver."
        units: "second"
      t_final:
        default: 0.1
        minimum: 0.0
        type: "number"
        description: "The final simulation time."
        units: "second"
      save_text_interval:
        default: 0.02
        minimum: 0.0
        type: "number"
        description: "The interval to use between saving text output files."
        units: "second"
      save_xdmf_interval:
        default: 0.1
        minimum: 0.0
        type: "number"
        description: "The interval to use between saving visualization/XDMF output files."
        units: "second"
      solver1_ksp:
        default: "cg"
        type: "string"
        description: "The solver to use for fluid solve 1 of 4"
        enum:
          - "cg"
          - "gmres"
      solver2_ksp:
        default: "cg"
        type: "string"
        description: "The solver to use for fluid solve 2 of 4"
        enum:
          - "cg"
          - "gmres"
      solver3_ksp:
        default: "cg"
        type: "string"
        description: "The solver to use for fluid solve 3 of 4"
        enum:
          - "cg"
          - "gmres"
      solver4_ksp:
        default: "cg"
        type: "string"
        description: "The solver to use for fluid solve 4 of 4"
        enum:
          - "cg"
          - "gmres"    
      solver1_pc:
        default: "hypre"
        type: "string"
        description: "The preconditioner to use for fluid solve 1 of 4"
        enum:
          - "jacobi"
          - "hypre"
      solver2_pc:
        default: "hypre"
        type: "string"
        description: "The preconditioner to use for fluid solve 2 of 4"
        enum:
          - "jacobi"
          - "hypre"
      solver3_pc:
        default: "hypre"
        type: "string"
        description: "The preconditioner to use for fluid solve 3 of 4"
        enum:
          - "jacobi"
          - "hypre"
      solver4_pc:
        default: "hypre"
        type: "string"
        description: "The preconditioner to use for fluid solve 3 of 4"
        enum:
          - "jacobi"
          - "hypre"    
  fluid:
    additionalProperties: false
    type: "object"
    # required:
    #   - turbulence_model
    # if:
    #   properties:
    #     turbulence_model:
    #       const: smagorinsky
    # then:
    #   required:
    #     - c_s
    # else:
    #   if:
    #     properties:
    #       turbulence_model:
    #         const: wale
    #   then:
    #     required:
    #       - c_w
    properties:
      u_ref:
        default: 8.0
        minimum: 0.0
        maximum: 100.0
        type: "number"
        description: "The velocity of the wind as measured at the panel elevation."
        units: "meter/second"
      nu:
        default: 1.8e-05
        minimum: 1.0e-06
        type: "number"
        description: "The kinematic viscosity of the fluid."
        units: "meter^s/second"
      dpdx:
        default: 0.0
        minimum: 0.0
        type: "number"
        description: "The constant pressure gradient to use to accelerate the flow."
        units: "Pa/m"
      turbulence_model:
        default: null
        type:
          - "string"
          - "null"
        description: "The turbulence model to use in the fluid solver."
        enum:
          - null
          - "smagorinsky"
          - "wale"
      c_s:
        default: 0.17
        minimum: 0.0
        type: "number"
        description: "The Smagorinsky coefficient."
      c_w:
        default: 0.5
        minimum: 0.0
        type: "number"
        description: "The WALE coefficient."
      bc_y_min:
        default: "noslip"
        type: "string"
        description: "The type of boundary to set on the y_min wall."
        enum:
          - "slip"
          - "noslip"
      bc_y_max:
        default: "noslip"
        type: "string"
        description: "The type of boundary to set on the y_max wall."
        enum:
          - "slip"
          - "noslip"
      bc_z_min:
        default: "noslip"
        type: "string"
        description: "The type of boundary to set on the z_min wall."
        enum:
          - "slip"
          - "noslip"
      bc_z_max:
        default: "noslip"
        type: "string"
        description: "The type of boundary to set on the z_max wall."
        enum:
          - "slip"
          - "noslip"
      periodic:
        default: false
        type: "boolean"
        description: "Control whether periodic boundary conditions are set on the y_min/y_max walls."

  structure:
    additionalProperties: false
    type: "object"
    # required:
    properties:
      elasticity_modulus:
        default: 190.0e+9
        minimum: 1.0e+2
        maximum: 500.0e+9
        type: "number"
        description: "The effective Young's modulus of the panel structure."
        units: "Pascal"  
      poissons_ratio: 
        default: 0.3
        minimum: 0.1
        maximum: 0.9
        type: "number"
        description: "poissons ratio of the panel structure."
        units: "None"
      body_force_x: 
        default:  100
        type: "number"
        description: "Body force applied on strucrure in the x direction"
        units: "Newton"
      body_force_y: 
        default:  100
        type: "number"
        description: "Body force applied on strucrure in the y direction"
        units: "Newton"
      body_force_z: 
        default:  100
        type: "number"
        description: "Body force applied on strucrure in the z direction"
        units: "Newton"
